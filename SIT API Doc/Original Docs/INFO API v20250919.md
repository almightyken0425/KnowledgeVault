# Overview  
  
This document provides comprehensive documentation for the INFO-API interfaces, including authentication, encryption methods, and all available endpoints.  
  
# Authentication  
  
## Headers Required  
  
All API requests must include the following headers:  
  
| Header | Description | Required | Example |  
|--------|-------------|----------|---------|  
| `access-key` | Partner access key for authentication | Yes | `partner_key_123` |  
| `sign` | HMAC-SHA256 signature for request verification | Yes | `AbC123...` |  
| `Content-Type` | Request content type | Yes | `application/json` |  
  
## Authentication Process  
  
1. **Access Key**: Provided by the platform administrator  
2. **Sign**: Generated using HMAC-SHA256 algorithm with request body and secret key  
3. **AgentId/AffiliateId**: Automatically injected by AuthFilter based on access-key  
  
# Encryption Methods  
  
## 1. Sign Encryption (HMAC-SHA256)  
  
Used for request signature verification to ensure data integrity and authenticity.  
  
### Algorithm: HMAC-SHA256  
- **Input**: Request body (JSON string) + Secret Key  
- **Output**: Base64-encoded signature string  
  
### Example Implementation:  
```javascript  
// Example request body  
const requestBody = {  
  "username": "player001",  "password": "encrypted_password_here",  "email": "player@example.com"};  
  
// Convert to JSON string  
const jsonString = JSON.stringify(requestBody);  
  
// Generate signature using HMAC-SHA256  
const secretKey = "your_secret_key_here";  
// Returns Base64 string 
const signature = hmacSHA256(jsonString, secretKey);  
  
// Add to request headers  
headers["sign"] = signature;  
```  
  
### Signature Generation Steps:  
1. Convert request body to JSON string (maintain exact format)  
2. Use HMAC-SHA256 with your secret key  
3. Encode result to Base64  
4. Include in `sign` header  
  
## 2. Password Encryption (AES-GCM)  
  
Used for encrypting sensitive data like passwords in request payloads.  
  
### Algorithm: AES-GCM with 256-bit key  
- **IV Length**: 12 bytes (randomly generated)  
- **Tag Length**: 128 bits  
- **Key Derivation**: SHA-256 of secret key  
  
### Example Implementation:  
```javascript  
// Encrypt password before sending  
const plainPassword = "user_password_123";  
const secretKey = "your_aes_secret_key";  
  
// AES-GCM encryption returns Base64 string with IV prefix  
const encryptedPassword = aesEncrypt(plainPassword, secretKey);  
  
// Use in request body  
const requestBody = {  
  "username": "player001",  "password": encryptedPassword  
  // AES-GCM encrypted and Base64 encoded
  };  
```  
  
### Encryption Process:  
1. Generate random 12-byte IV  
2. Derive 256-bit key using SHA-256 of secret key  
3. Encrypt using AES-GCM  
4. Prepend IV to ciphertext  
5. Encode to Base64  

----

# API Endpoints  
  
## Login History API  
  
### Get All Failed Login Attempts  
  
**Function**: Retrieve failed login attempt records with filtering options  
  
**HTTP Method**: `GET`  
  
**URI**: `/api/login/getAllFailedLoginAttempts`  
  
**Request Parameters** (Query String):  
  
| Parameter | Type | Required | Length | Description | Example |  
|-----------|------|----------|--------|-------------|----------|  
| `limit` | Integer | No | - | Page size (default: 20) | `50` |  
| `page` | Integer | No | - | Page number (default: 1) | `1` |  
| `tag` | String | No | 50 | Filter tag | `"VIP"` |  
| `username` | String | No | 50 | Player username | `"player001"` |  
| `dateFrom` | DateTime | No | - | Start date | `"2024-01-01 00:00:00"` |  
| `dateTo` | DateTime | No | - | End date | `"2024-01-31 23:59:59"` |  
  
**Date Format**: YYYY-MM-DDTHH:mm:ss  
  
**Request Example**:  
```http  
GET /api/login/getAllFailedLoginAttempts?username=player001&limit=20&page=1  
Headers:  
  access-key: partner_key_123  sign: AbC123...
```  

**Normal Response**:  
```json  
{  
  "data": 
  [    
	  {      
		  "id": 12345,      
		  "username": "player001",      
		  "date": "2024-01-15 10:30:00",      
		  "loginStatus": "FAILED",      
		  "accountStatus": "ACTIVE",      
		  "referrer": "https://partner.com",      
		  "ip": "192.168.1.100",      
		  "device": "Mobile",      
		  "clientEnd": "Android",      
		  "tag": ["VIP", "NEW"]    
		  }  
  ],  
  "totalElements": 1,  
  "totalPages": 1,  
  "size": 20
}  
```  

Note:
* limit between 90 days
* Date time use system zone +08:00
  
---  
  
## Player API  
  
### Player Registration  
  
**Function**: Register new player account for partner sites  
  
**HTTP Method**: `POST`  
  
**URI**: `/api/player/register`  
  
**Request Parameters** (JSON Body):  
  
| Parameter | Type | Required | Length | Description | Example |  
|-----------|------|----------|--------|-------------|----------|  
| `username` | String | Yes | 50 | Username (alphanumeric only) | `"player001"` |  
| `password` | String | Yes | 50 | AES-GCM encrypted password | `"rKo7oH0T..."` |  
| `email` | String | No | 200 | Valid email address | `"player@example.com"` |  
| `phonenumber` | String | No | 20 | Phone number | `"+886988245107"` |  
  
**Request Example**:  
```http  
POST /api/player/register  
Headers:  
  access-key: partner_key_123  sign: AbC123...  Content-Type: application/json  
Body:  
{  
  "username": "player001",  
  "password": "rKo7oH0TTUub+xghsTm/ZEv85dEcGwkVQqN36GZoa/PZ3wE=",  
  "email": "player@example.com",  
  "phonenumber": "+886988245107"
}  
```  
  
**Normal Response**:  
```json  
{
    "success": true,
    "code": 200,
    "message": "",
    "messageConstant": "SUCCESS",
    "data": {
        "messages": [],
        "playerId": 26197,
        "account": "player001",
        "email": "player@example.com",
        "phone": "+886988245107",
        "agentId": 7,
        "affiliateId": null,
        "languageId": null,
        "success": true
    },
    "exAction": "",
    "exActionData": ""
}
```  
  
* Email addresses and phone numbers must not be duplicated.
* Whether email and phone number are required fields is determined by backend configuration.

  
### Player Login  
  
**Function**: Authenticate player and return login session  
  
**HTTP Method**: `POST`  
  
**URI**: `/api/player/login`  
  
**Request Parameters** (JSON Body):  
  
| Parameter | Type | Required | Length | Description | Example |  
|-----------|------|----------|--------|-------------|----------|  
| `username` | String | Yes | 50 | Player username | `"player001"` |  
| `password` | String | Yes | 50 | AES-GCM encrypted password | `"rKo7oH0T..."` |  
  
**Request Example**:  
```http  
POST /api/player/login  
Headers:  
  access-key: partner_key_123  sign: AbC123...  Content-Type: application/json  
Body:  
{  
  "username": "player001",  
  "password": "rKo7oH0TTUub+xghsTm/ZEv85dEcGwkVQqN36GZoa/PZ3wE="
}  
```  
  
**Normal Response**:  
```json  
{
    "success": true,
    "code": 200,
    "message": "",
    "messageConstant": "SUCCESS",
    "data": {
        "account": "player001",
        "fullName": "",
        "token": "",
        "affiliate": "",
        "phone": "",
        "mail": "",
        "profileIntegrity": "N",
        "kycVerified": false,
        "haveBankCard": "N",
        "phoneVerified": "N",
        "mailVerified": "N",
        "createdTime": "2025-09-09 10:42:02",
        "avatar": 1,
        "allowReferral": false
    },
    "exAction": "",
    "exActionData": ""
} 
```  
  
Note:
* Date time use system zone +08:00

 ----
  
### Get All Players  
  
**Function**: Retrieve player list with complex filtering and pagination  
  
**HTTP Method**: `GET`  
  
**URI**: `/api/player/getAllPlayer`  
  
**Request Parameters** (Query String):  
  
| Parameter | Type | Required | Length | Description | Example |  
|-----------|------|----------|--------|-------------|----------|  
| `limit` | Integer | No | Max: 1000 | Page size (default: 20) | `100` |  
| `page` | Integer | No | - | Page number (default: 1) | `1` |  
| `username` | String | No | 50 | Filter by username | `"player001"` |  
| `tag` | String Array | No | - | Filter by tags | `["VIP","NEW"]` |  
| `dateFrom` | DateTime | No | - | Registration start date | `"2024-01-01 00:00:00"` |  
| `dateTo` | DateTime | No | - | Registration end date | `"2024-01-31 23:59:59"` |  
| `firstName` | String | No | 50 | Filter by first name | `"John"` |  
| `affiliate` | String | No | 50 | Filter by affiliate username | `"affiliate001"` |  
| `vipLevel` | String | No | 10 | Filter by VIP level | `"VIP1"` |  
| `email` | String | No | 200 | Filter by email | `"user@example.com"` |  
| `phoneNumber` | String | No | 20 | Filter by phone number | `"+886988245107"` |  
| `accountStatus` | String | No | 20 | Filter by account status | `"ACTIVE"` |  
  
**Date Format**: YYYY-MM-DDTHH:mm:ss  
  
**Request Example**:  
```http  
GET /api/player/getAllPlayer?limit=50&page=1 
Headers:  
  access-key: partner_key_123  sign: AbC123...
```  
  
**Normal Response**:  
```json  
{
    "success": true,
    "code": 200,
    "message": "",
    "messageConstant": "SUCCESS",
    "data": {
        "username": "vk0602",
        "email": "vk0602@cc.cc",
        "playerId": 23124,
        "accountStatus": "ACTIVE",
        "createdAt": "2025-01-21 16:55:37",
        "firstName": "vk0602",
        "lastName": "vk0602",
        "phoneNumber": null,
        "imAccount1": null,
        "imAccount2": null,
        "imAccount3": null,
        "vipLevel": 0,
        "lastLoginTime": "2025-08-13 16:48:46",
        "tags": [
            "test",
            "test2",
            "hacker"
        ],
        "affiliate": null,
        "totalRevenueInMonth": 0,
        "netDepositInMonth": 0,
        "firstDepositDateInMonth": null,
        "lastDepositDate": "2025-01-21 16:56:09",
        "totalDepositRequest": 0,
        "totalDepositAmount": 200,
        "daysSinceLastDeposit": 233,
        "address": "TEST ADDRESS",
        "birthday": "2025-09-11"
    },
    "exAction": "",
    "exActionData": ""
}
```  

* Date time use system zone +08:00


----

### Get Player Profile  
  
**Function**: Retrieve detailed information for a specific player  
  
**HTTP Method**: `GET`  
  
**URI**: `/api/player/getPlayerProfile`  
  
**Request Parameters** (Query String):  
  
| Parameter | Type | Required | Length | Description | Example |  
|-----------|------|----------|--------|-------------|----------|  
| `username` | String | Yes | 50 | Player username | `"player001"` |  
  
**Request Example**:  
```http  
GET /api/player/getPlayerProfile?username=vk0602  
Headers:  
  access-key: partner_key_123  sign: AbC123...
```  


**Normal Response**:  
```json  
{
    "success": true,
    "code": 200,
    "message": "",
    "messageConstant": "SUCCESS",
    "data": {
        "username": "vk0602",
        "email": "vk0602@cc.cc",
        "playerId": 23124,
        "accountStatus": "ACTIVE",
        "createdAt": "2025-01-21 16:55:37",
        "firstName": "vk0602",
        "lastName": "vk0602",
        "phoneNumber": null,
        "imAccount1": null,
        "imAccount2": null,
        "imAccount3": null,
        "vipLevel": 0,
        "lastLoginTime": "2025-08-13 16:48:46",
        "tags": [
            "test",
            "test2",
            "hacker"
        ],
        "affiliate": null,
        "totalRevenueInMonth": 0,
        "netDepositInMonth": 0,
        "firstDepositDateInMonth": null,
        "lastDepositDate": "2025-01-21 16:56:09",
        "totalDepositRequest": 0,
        "totalDepositAmount": 200,
        "daysSinceLastDeposit": 233,
        "address": "TEST ADDRESS",
        "birthday": "2025-09-11"
    },
    "exAction": "",
    "exActionData": ""
} 
```  


Note:
* Date time use system zone +08:00

---  
  
## Player Hourly Report API  
  
### Get Player Turnover Statistics  
  
**Function**: Retrieve player turnover statistics grouped by game type in dynamic format  
  
**HTTP Method**: `POST`  
  
**URI**: `/api/player/getTurnover`  
  
**Request Parameters** (JSON Body):  
  
| Parameter | Type | Required | Length | Description | Example |  
|-----------|------|----------|--------|-------------|----------|  
| `dateFrom` | ZonedDateTime | Yes | - | Start date | `"2020-01-30T16:00:00+08:00"` |  
| `dateTo` | ZonedDateTime | Yes | - | End date | `"2026-05-31T15:00:00+08:00"` |  
| `agentId` | Long | Yes | - | Agent ID (must be > 0) | `12345` |  
| `playerId` | Long | Yes | - | Player ID | `123456` |  
| `username` | String | Yes | 50 | Player username | `"player001"` |  
  
**Date Format**: YYYY-MM-DDTHH:mm:ssZ  
  
**Request Example**:  
```http  
POST /api/player/getTurnover  
Headers:  
  access-key: partner_key_123  sign: AbC123...  Content-Type: application/json  
Body:  
{  
  "dateFrom": "2020-01-30T16:00:00+08:00",  
  "dateTo": "2026-05-31T15:00:00+08:00",
  "username": "player001"
}  
```  
  
**Normal Response**:  
```json  
{
    "total": 3671.2,
    "gameTypeAmounts": {
        "SLOTS": 3600,
        "CARDS": 71.2
    }
}
```  

----
  
# Rate Limiting  
  
- **Default Limit**: 60 requests per minute per access-key  
  
# Security Best Practices  
  
1. **Always use HTTPS** for API requests  
2. **Keep secret keys secure** and rotate regularly  
3. **Validate signatures** on every request  
4. **Encrypt sensitive data** using AES-GCM  
5. **Implement proper error handling** to avoid information leakage  
6. **Monitor rate limits** and implement backoff strategies  
7. **Log security events** for audit purposes  
  
  
---  
  